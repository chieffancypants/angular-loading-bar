/*!
 * angular-loading-bar v0.8.0
 * https://chieffancypants.github.io/angular-loading-bar
 * Copyright (c) 2015 Wes Cruver
 * License: MIT
 */
!function(){"use strict";angular.module("angular-loading-bar",["cfp.loadingBarInterceptor"]),angular.module("chieffancypants.loadingBar",["cfp.loadingBarInterceptor"]),angular.module("cfp.loadingBarInterceptor",["cfp.loadingBar"]).config(["$httpProvider",function(e){var n=["$q","$cacheFactory","$timeout","$rootScope","$log","cfpLoadingBar",function(n,t,a,r,i,c){function o(){a.cancel(l),c.complete(),u=0,s=0}function d(n){var a,r=t.get("$http"),i=e.defaults;!n.cache&&!i.cache||n.cache===!1||"GET"!==n.method&&"JSONP"!==n.method||(a=angular.isObject(n.cache)?n.cache:angular.isObject(i.cache)?i.cache:r);var c=void 0!==a?void 0!==a.get(n.url):!1;return void 0!==n.cached&&c!==n.cached?n.cached:(n.cached=c,c)}var l,s=0,u=0,p=c.latencyThreshold;return r.$on("cfpLoadingBar:requestCompleted",function(){u++}),{request:function(e){return e.ignoreLoadingBar||d(e)||(r.$broadcast("cfpLoadingBar:loading",{url:e.url}),0===s&&(l=a(function(){c.start()},p)),s++,c.set(u/s)),e},response:function(e){return e&&e.config?(e.config.ignoreLoadingBar||d(e.config)||(u++,r.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),u>=s?o():c.set(u/s)),e):(i.error("Broken interceptor detected: Config object not supplied in response:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),e)},responseError:function(e){return e&&e.config?(e.config.ignoreLoadingBar||d(e.config)||(u++,r.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),u>=s?o():c.set(u/s)),n.reject(e)):(i.error("Broken interceptor detected: Config object not supplied in rejection:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),n.reject(e))}}}];e.interceptors.push(n)}]),angular.module("cfp.loadingBar",[]).provider("cfpLoadingBar",function(){this.autoIncrement=!0,this.includeSpinner=!0,this.includeBar=!0,this.latencyThreshold=100,this.startSize=.02,this.parentSelector="body",this.spinnerTemplate='<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>',this.loadingBarTemplate='<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',this.$get=["$injector","$document","$timeout","$rootScope",function(e,n,t,a){function r(){u||(u=e.get("$animate"));var r=n.find(h).eq(0);t.cancel(g),B||(a.$broadcast("cfpLoadingBar:started"),B=!0,L&&u.enter(f,r,angular.element(r[0].lastChild)),S&&u.enter(v,r,angular.element(r[0].lastChild)),i(y))}function i(e){if(B){var n=100*e+"%";m.css("width",n),$=e,b&&(t.cancel(p),p=t(function(){c()},250))}}function c(){if(!(o()>=1)){var e=0,n=o();e=n>=0&&.25>n?(3*Math.random()+3)/100:n>=.25&&.65>n?3*Math.random()/100:n>=.65&&.9>n?2*Math.random()/100:n>=.9&&.99>n?.005:0;var t=o()+e;i(t)}}function o(){return $}function d(){$=0,B=!1}function l(){u||(u=e.get("$animate")),a.$broadcast("cfpLoadingBar:completed"),i(1),t.cancel(g),g=t(function(){var e=u.leave(f,d);e&&e.then&&e.then(d),u.leave(v)},500)}function s(){a.$broadcast("cfpLoadingBar:requestCompleted")}var u,p,g,h=this.parentSelector,f=angular.element(this.loadingBarTemplate),m=f.find("div").eq(0),v=angular.element(this.spinnerTemplate),B=!1,$=0,b=this.autoIncrement,S=this.includeSpinner,L=this.includeBar,y=this.startSize;return{start:r,set:i,status:o,inc:c,complete:l,incCompletedRequests:s,autoIncrement:this.autoIncrement,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize}}]})}();
